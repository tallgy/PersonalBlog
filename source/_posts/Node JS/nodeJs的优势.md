---
title: nodeJs的优势
date: 2023-08-16 11:15:41
tags:
 - nodeJs
categories:
 - nodeJs
---

# nodeJs 优势和特点

## 特点

* 它是一个 JavaScript 运行环境
* 依赖于 Chrome V8 引擎进行代码解释
```
ChromeV8 :
V8 使用 C++开发，并在谷歌浏览器中使用。在运行 JavaScript 之前，相比其它的 JavaScript 的引擎转换成字节码或解释执行，
V8 将其编译成原生机器码（IA-32, x86-64, ARM, or MIPS CPUs），并且使用了如内联缓存（inline caching）等方法来提高性能。
有了这些功能，JavaScript 程序在 V8 引擎下的运行速度媲美二进制程序
```
* 事件驱动
* 非阻塞I/O
* 轻量、可伸缩，适于实时数据交互应用
* 单进程，单线程


### 并发连接

* 异步、事件驱动模型（NodeJS核心特点）

node js 的异步是使用的 回调的方式进行的处理。

我们同样是要发起请求，等待服务器端响应；
异步操作结束后会执行后续逻辑，这个通知动作在NodeJS中叫做回调（ Callback ）
能在事件（I/O）处理完成后继续执行后面的逻辑，这体现了NodeJS的显著特点，异步机制、事件驱动整个过程没有阻塞新用户的连接，也不需要维护已连接用户和I/O操作之间的连接。
基于这样的机制，理论上陆续有用户请求连接，NodeJS都可以进行响应，因此NodeJS能支持比Java、PHP程序更高的并发量，虽然维护事件队列也需要成本
再由于NodeJS是单线程，事件队列越长，得到响应的时间就越长，并发量上去还是会力不从心。
总结一下NodeJS是怎么解决并发连接这个问题的：更改连接到服务器的方式，每个连接发射（emit）一个在NodeJS引擎进程中运行的事件（Event），放进事件队列当中，而不是为每个连接生成一个新的OS线程（并为其分配一些配套内存）。


### I/O 阻塞


NodeJS遇到I/O事件会创建一个线程去执行，然后主线程会继续往下执行的，因此，拿profile的动作触发一个I/O事件，马上就会执行拿timeline的动作，两个动作并行执行，假如各需要1S，那么总的时间也就是1S。它们的I/O操作执行完成后，发射一个事件，profile和timeline，事件代理接收后继续往下执行后面的逻辑，这就是NodeJS非阻塞I/O的特点。


### 总结

Java、PHP也有办法实现并行请求（子线程），但NodeJS通过回调函数（Callback）和异步机制会做得很自然。



## 优点

* 高并发（最重要）
* 适合I/O密集型应用


## 缺点

* 不适合CPU密集型应用
* CPU密集型应用给Node带来的挑战主要是：由于JavaScript单线程的原因，如果有长时间运行的计算（比如大循环），将会导致CPU时间片不能释放，使得后续I/O无法发起；
* 解决方案：分解大型运算任务为多个小任务，使得运算能够适时释放，不阻塞I/O调用的发起。
* 只支持单核CPU，不能充分利用CPU
* 可靠性低，一旦代码某个环节崩溃，整个系统都崩溃
* 原因：单进程，单线程。
  解决方案：
  （1）Nnigx反向代理，负载均衡，开多个进程，绑定多个端口；
  （2）开多个进程监听同一个端口，使用cluster模块；
* 开源组件库质量参差不齐，更新快，向下不兼容；
* Debug不方便，错误没有stack trace。

