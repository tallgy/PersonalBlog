---
title: 图片懒加载的实现
date: 2023-07-31 19:08:53
tags: 
- 浏览器
categories:
- 浏览器
---

# 浏览器图片懒加载

图片懒加载主要是 src 
用 data-src 去存储真正显示的值，然后进行替换。
实现了懒加载的目的

```JavaScript

// 图片懒加载
const lazyload = () => {
  // 获取所有的图片列表
  const imgs = document.getElementsByClassName('img');
  const len = imgs.length;

  return () => {
    // 获取可见高度
    const seeHeight = document.documentElement.clientHeight;
    // 获取滚动的高度
    const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;

    for(var i = n; i < len; i++) {
      // 如果 当前图片的 偏移高度属于这个里面
      // 应该还有一个设置，应该是图片在这个视框里面
      // 所以这个应该是有问题的
      if(images[i].offsetTop < seeHeight + scrollTop) {
        // 进行替换
        if(images[i].getAttribute('src') === 'images/loading.gif') {
          images[i].src = images[i].getAttribute('data-src');
        }
        n = n + 1;
      }
    }
  }
}

var loadImages = lazyload();
loadImages();          // 初始化首页的页面图片
// 监听 scroll ， 同时添加防抖
window.addEventListener('scroll', debounce(loadImages, 500), false);

```